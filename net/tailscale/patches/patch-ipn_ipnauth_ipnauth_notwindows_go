https://github.com/tailscale/tailscale/issues/17209

From 8ec07b5f7fc31e5d86aa9db4f0c7fe5498d3f9fa Mon Sep 17 00:00:00 2001
From: Brad Fitzpatrick <bradfitz@tailscale.com>
Date: Sun, 21 Sep 2025 08:08:41 -0700
Subject: [PATCH] ipn/ipnauth: don't crash on OpenBSD trying to log username of
 unknown peer

Index: ipn/ipnauth/ipnauth_notwindows.go
--- ipn/ipnauth/ipnauth_notwindows.go.orig
+++ ipn/ipnauth/ipnauth_notwindows.go
@@ -18,8 +18,13 @@ import (
 func GetConnIdentity(_ logger.Logf, c net.Conn) (ci *ConnIdentity, err error) {
 	ci = &ConnIdentity{conn: c, notWindows: true}
 	_, ci.isUnixSock = c.(*net.UnixConn)
-	if ci.creds, _ = peercred.Get(c); ci.creds != nil {
+	if ci.creds, err = peercred.Get(c); ci.creds != nil {
 		ci.pid, _ = ci.creds.PID()
+	} else if err == peercred.ErrNotImplemented {
+		// peercred.Get is not implemented on this OS (such as OpenBSD)
+		// Just leave creds as nil, as documented.
+	} else if err != nil {
+		return nil, err
 	}
 	return ci, nil
 }
